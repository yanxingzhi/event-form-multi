<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>活動报名系统 | Event Registration</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: sans-serif; max-width: 600px; margin: auto; }
  label { display: block; margin-top: 12px; }
  select, input, textarea { width: 100%; padding: 8px; margin-top: 4px; }
  button { margin-top: 16px; padding: 10px; }
  .lang-switch { margin-bottom: 20px; }
</style>
</head>
<body>

<div class="lang-switch">
  <label for="langSelect">🌐 Language / 言語 / 语言:</label>
  <select id="langSelect">
    <option value="ja">日本語</option>
    <option value="en">English</option>
    <option value="zh">中文</option>
  </select>
</div>

<form id="eventForm">
  <label data-i18n="eventName">イベント名 / Event Name / 活动名称</label>
  <input type="text" name="eventName" required>

  <label data-i18n="name">お名前 / Name / 姓名</label>
  <input type="text" name="name" required>

  <label data-i18n="sex">性別 / Sex / 性别</label>
  <select name="sex" required>
    <option value="">--</option>
    <option value="Male" data-i18n="male">男性 / Male / 男</option>
    <option value="Female" data-i18n="female">女性 / Female / 女</option>
  </select>

  <label data-i18n="nationality">国籍 / Nationality / 国籍</label>
  <input type="text" name="nationality" required>

  <label data-i18n="phone">電話番号 / Phone Number / 电话</label>
  <input type="tel" name="phone" required>

  <label data-i18n="email">メールアドレス / Email Address / 邮箱</label>
  <input type="email" name="email" required>

  <label data-i18n="school">学校名又は勤務先 / School or Workplace / 学校或单位</label>
  <input type="text" name="school">

  <label data-i18n="message">質問 / Message / 留言</label>
  <textarea name="message"></textarea>

  <input type="hidden" name="activityId" value="">

  <button type="submit" data-i18n="submit">送信 / Submit / 提交</button>
</form>

<script>
const translations = {
  ja: {
    eventName: "イベント名",
    name: "お名前",
    sex: "性別",
    male: "男性",
    female: "女性",
    nationality: "国籍",
    phone: "電話番号",
    email: "メールアドレス",
    school: "学校名又は勤務先",
    message: "質問",
    submit: "送信"
  },
  en: {
    eventName: "Event Name",
    name: "Name",
    sex: "Sex",
    male: "Male",
    female: "Female",
    nationality: "Nationality",
    phone: "Phone Number",
    email: "Email Address",
    school: "School or Workplace",
    message: "Message or Question",
    submit: "Submit"
  },
  zh: {
    eventName: "活动名称",
    name: "姓名",
    sex: "性别",
    male: "男",
    female: "女",
    nationality: "国籍",
    phone: "电话",
    email: "邮箱",
    school: "学校或单位",
    message: "留言",
    submit: "提交"
  }
};

document.getElementById('langSelect').addEventListener('change', function() {
  const lang = this.value;
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (translations[lang] && translations[lang][key]) {
      el.textContent = translations[lang][key];
    }
  });
});

document.getElementById('eventForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  if (!confirm("Are you sure you want to submit? / 確認しますか？ / 确认提交吗？")) {
    return;
  }

  const formData = Object.fromEntries(new FormData(e.target).entries());

  const res = await fetch('/api/submit', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(formData)
  });

  if (res.ok) {
    alert('Success! / 成功しました！ / 提交成功！');
    e.target.reset();
  } else {
    alert('Error! / エラーが発生しました / 提交失败！');
  }
});
</script>

</body>
</html>
